<!DOCTYPE html>
<html>
<head>
    <title>DOM Test</title>
    <style>
        body { font-family: monospace; background: #000; color: #0f0; padding: 20px; }
        pre { background: #111; padding: 10px; overflow-x: auto; }
        .section { margin: 20px 0; border: 1px solid #0f0; padding: 10px; }
    </style>
</head>
<body>
    <h1>DOM State Inspector</h1>
    
    <div class="section">
        <h2>Mode 1 (Professional) State:</h2>
        <pre id="mode1-output"></pre>
    </div>
    
    <div class="section">
        <h2>Mode 2 (Schizo) State:</h2>
        <pre id="mode2-output"></pre>
    </div>
    
    <iframe id="test-frame" src="http://localhost:4000" width="100%" height="600" style="border: 1px solid #0f0;"></iframe>
    
    <script>
        function inspectDOM(doc, mode) {
            const output = [];
            output.push(`=== MODE: ${mode} ===`);
            output.push(`Body classes: ${doc.body.className}`);
            output.push('');
            
            // Check nav links
            const navLinks = doc.querySelectorAll('.site-nav a');
            output.push('Navigation Links:');
            navLinks.forEach((link, i) => {
                output.push(`  Link ${i}: ${link.className || '(no class)'}`);
                output.push(`    Text content: "${link.textContent}"`);
                output.push(`    Inner HTML: "${link.innerHTML}"`);
                
                // Check computed styles
                const computed = doc.defaultView.getComputedStyle(link);
                output.push(`    Font size: ${computed.fontSize}`);
                output.push(`    Display: ${computed.display}`);
                output.push(`    Visibility: ${computed.visibility}`);
                
                // Check pseudo-element
                const afterContent = doc.defaultView.getComputedStyle(link, '::after').content;
                const afterFontSize = doc.defaultView.getComputedStyle(link, '::after').fontSize;
                const afterColor = doc.defaultView.getComputedStyle(link, '::after').color;
                output.push(`    ::after content: ${afterContent}`);
                output.push(`    ::after font-size: ${afterFontSize}`);
                output.push(`    ::after color: ${afterColor}`);
                
                // Check attributes
                output.push(`    Attributes:`);
                for (let attr of link.attributes) {
                    output.push(`      ${attr.name}: "${attr.value}"`);
                }
                output.push('');
            });
            
            return output.join('\n');
        }
        
        window.addEventListener('load', () => {
            const iframe = document.getElementById('test-frame');
            
            iframe.onload = () => {
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                
                setTimeout(() => {
                    // Capture Mode 1 state
                    const mode1State = inspectDOM(iframeDoc, 'PROFESSIONAL');
                    document.getElementById('mode1-output').textContent = mode1State;
                    
                    // Click REAL button to switch to Mode 2
                    const realBtn = iframeDoc.querySelector('[data-mode="consciousness"]');
                    if (realBtn) {
                        realBtn.click();
                        
                        // Wait for transition
                        setTimeout(() => {
                            const mode2State = inspectDOM(iframeDoc, 'SCHIZO/REAL');
                            document.getElementById('mode2-output').textContent = mode2State;
                        }, 1000);
                    }
                }, 1000);
            };
        });
    </script>
</body>
</html>